---
name: task-planner
description: 사용자가 명시적으로 작업 계획이나 프로젝트 계획을 요청할 때 사용해야 합니다 (예 "plan this task", "create a plan", "계획 세워줘"). .serena/memories 폴더의 컨텍스트를 활용하고, 병렬 실행을 위한 적절한 서브에이전트를 할당하며, 코드베이스 작업에 serena 도구를 사용하고, 사용자 중심의 계획을 제대로 문서화하는 포괄적인 계획 워크플로우를 제공합니다.
---

# 작업 계획 수립 (Task Planner)

## 개요

이 스킬은 병렬 서브에이전트 실행을 통해 효율성을 극대화하는 포괄적이고 실행 가능한 계획을 생성하여 지능적인 프로젝트 및 작업 계획을 가능하게 합니다. 모든 계획이 .serena/memories 폴더의 기존 프로젝트 컨텍스트를 참조하고, 적절한 도구(특히 코드베이스 작업을 위한 serena)를 사용하며, 요청되지 않은 기능을 추가하지 않고 사용자 요구사항에만 엄격히 집중하도록 보장합니다.

---

## ⚠️ 중요: 모든 단계 필수 수행

**계획을 수립할 때 아래의 모든 8단계를 반드시 순서대로 수행해야 합니다.**

단계를 건너뛰면 불완전하고 실행 불가능한 계획이 생성됩니다.

각 단계를 완료할 때마다 **명시적으로 해당 단계의 결과를 출력**하세요.

---

## 계획 수립 워크플로우

### 📍 Step 1: .serena/memories에서 컨텍스트 수집 (필수)

**⚠️ 이 단계를 건너뛰지 마세요!**

계획을 생성하기 전에 반드시 .serena/memories 폴더에서 관련 프로젝트 컨텍스트를 확인하세요:

**필수 작업:**
1. `mcp__serena-mcp__list_memories` 도구를 사용하여 사용 가능한 메모리 확인
2. `mcp__serena-mcp__read_memory` 도구를 사용하여 관련 메모리 읽기:
   - 이전 작업 및 결정사항
   - 프로젝트 구조 및 규칙
   - 알려진 문제 또는 제약사항
   - 기존 패턴 및 관행
3. 가능하면 CLAUDE.md 참조하여 프로젝트별 가이드라인 확인

**출력 형식:**
```markdown
## Step 1 완료: .serena/memories 컨텍스트

### 읽은 메모리:
- [메모리 이름 1]: [핵심 내용 요약]
- [메모리 이름 2]: [핵심 내용 요약]

### CLAUDE.md 핵심 사항:
- [핵심 가이드라인 1]
- [핵심 가이드라인 2]

### 프로젝트 컨텍스트 요약:
[이전 작업, 기술 스택, 패턴 등 핵심 정보]
```

---

### 📍 Step 2: 사용자 요구사항 및 제공된 지침 분석 (필수)

사용자가 **명시적으로 요청한 것**과 **제공한 구체적인 지침**을 신중하게 분석하세요:

**필수 작업:**
1. 사용자가 언급한 각 구체적인 요구사항 나열
2. 사용자가 제공한 **모든 지침, 제약사항, 가이드라인** 추출:
   - 기술 스택 지정 (예: "Python 사용", "FastMCP로 만들어")
   - 아키텍처 패턴 (예: "MVC 패턴으로", "마이크로서비스 구조")
   - 성능 요구사항 (예: "응답 시간 100ms 이하")
   - 보안 요구사항
   - 코딩 컨벤션
   - 기타 제약사항
3. **중요**: 가정이나 명시적으로 요청되지 않은 기능 확인
4. 요구사항이 불명확하면 `AskUserQuestion` 도구를 사용하여 명확히 하기
5. 계획이 요청된 것**만** 다루는지 검증 - 추가 사항 없음

**황금 규칙**: 사용자가 요청하지 않았다면, 계획에 포함하지 마세요.

**출력 형식:**
```markdown
## Step 2 완료: 요구사항 및 지침 분석

### 사용자 요구사항:
1. [명시적 요구사항 1]
2. [명시적 요구사항 2]
3. [명시적 요구사항 3]
...

### 사용자 제공 지침 및 제약사항:
#### 기술 스택:
- [기술/라이브러리 1]
- [기술/라이브러리 2]

#### 아키텍처 패턴:
- [패턴 또는 구조]

#### 성능 요구사항:
- [성능 지표]

#### 기타 제약사항:
- [제약사항 1]
- [제약사항 2]

### 제외할 항목 (사용자가 요청하지 않은 것):
- [가정 또는 추가 기능 1]
- [가정 또는 추가 기능 2]
```

---

### 📍 Step 3: 하위 작업으로 분해 (필수)

작업을 명확하고 관리 가능한 하위 작업으로 분해하세요:

**필수 작업:**
1. 주요 작업 카테고리 식별
2. 각 카테고리를 구체적이고 실행 가능한 하위 작업으로 세분화
3. 하위 작업 간 의존성 결정
4. 병렬로 실행할 수 있는 독립적인 작업 그룹화

**출력 형식:**
```markdown
## Step 3 완료: 하위 작업 분해

### 작업 카테고리:
1. [카테고리 1] (예: 백엔드 개발)
2. [카테고리 2] (예: 프론트엔드 개발)
3. [카테고리 3] (예: 테스트)

### 하위 작업 목록:
1. **[작업 1 이름]**
   - 설명: [상세 설명]
   - 의존성: 없음 (독립)

2. **[작업 2 이름]**
   - 설명: [상세 설명]
   - 의존성: 없음 (독립)

3. **[작업 3 이름]**
   - 설명: [상세 설명]
   - 의존성: 작업 1, 작업 2

### 의존성 트리:
```
작업 1 ─┐
작업 2 ─┼─→ 작업 3 ─→ 작업 4
```
```

---

### 📍 Step 4: 적절한 서브에이전트 할당 (필수)

**⚠️ 각 하위 작업에 반드시 서브에이전트를 할당하세요!**

작업 유형에 따라 가장 적절한 서브에이전트를 할당하세요:

**사용 가능한 서브에이전트:**
- `backend-api-developer`: 서버 사이드 로직, REST API, 데이터베이스 작업, 인증
- `frontend-ui-developer`: UI 컴포넌트, 반응형 레이아웃, 스타일링, 프론트엔드 프레임워크
- `ui-ux-designer`: 인터페이스 분석, 사용자 플로우, 디자인 시스템, 와이어프레임
- `web-app-tester`: 자동화 테스트, 성능 모니터링, UI/UX 검증
- `code-debugger`: 버그 식별, 디버깅, 오류 해결
- `technical-documentation-writer`: 문서 업데이트, 진행 상황 추적
- `Explore`: 빠른 코드베이스 탐색 (구조 이해용)
- `Plan`: 작업 계획 및 분해
- `general-purpose`: 복잡한 다단계 작업, 리서치, 코드 검색

**서브에이전트 선택 가이드:**
```
작업 유형 → 권장 서브에이전트
---
API 엔드포인트 생성 → backend-api-developer
데이터베이스 스키마 설계 → backend-api-developer
React 컴포넌트 생성 → frontend-ui-developer
스타일링 및 CSS 작업 → frontend-ui-developer
디자인 리뷰 → ui-ux-designer
웹 앱 테스트 → web-app-tester
버그 수정 → code-debugger
문서 작성 → technical-documentation-writer
코드베이스 이해 → Explore
리서치 질문 → general-purpose
```

**출력 형식:**
```markdown
## Step 4 완료: 서브에이전트 할당

### 작업별 서브에이전트:
1. **[작업 1 이름]**
   - 할당된 서브에이전트: `[서브에이전트 이름]`

2. **[작업 2 이름]**
   - 할당된 서브에이전트: `[서브에이전트 이름]`

...
```

---

### 📍 Step 5: 병렬 실행 계획 (필수)

**⚠️ 병렬 실행 가능한 모든 작업을 찾아 배치로 그룹화하세요!**

동시에 실행할 수 있는 작업을 식별하여 효율성을 극대화하세요:

**필수 작업:**
1. 의존성이 없는 작업 그룹화
2. 실행 배치 생성:
   - **Batch 1**: 모든 독립 작업 (병렬 실행)
   - **Batch 2**: Batch 1에만 의존하는 작업 (병렬 실행)
   - **Batch 3**: Batch 2에 의존하는 작업 (병렬 실행)
   - 계속...

**출력 형식:**
```markdown
## Step 5 완료: 병렬 실행 계획

### Batch 1 (병렬 실행 - 독립 작업):
- 작업 1.1: [작업 이름] - [서브에이전트]
- 작업 1.2: [작업 이름] - [서브에이전트]
- 작업 1.3: [작업 이름] - [서브에이전트]

### Batch 2 (병렬 실행 - Batch 1 이후):
- 작업 2.1: [작업 이름] - [서브에이전트] (의존: 1.1, 1.2)
- 작업 2.2: [작업 이름] - [서브에이전트] (의존: 1.3)

### Batch 3 (순차 실행 - Batch 2 이후):
- 작업 3.1: [작업 이름] - [서브에이전트] (의존: 2.1, 2.2)

### 병렬 실행 전략:
- 총 배치 수: [N개]
- 최대 동시 실행 작업 수: [M개]
- 예상 시간 단축: [순차 대비 X%]
```

---

### 📍 Step 6: 도구 사용 명시 (필수 - 특히 Serena!)

**⚠️ 각 하위 작업에 사용할 도구를 반드시 명시하세요!**
**⚠️ 코드베이스 작업에는 반드시 serena 도구를 지정하세요!**

각 하위 작업에 사용해야 할 도구를 지정하세요:

**필수 도구 요구사항:**

1. **모든 코드베이스 작업**: 반드시 serena 도구 사용
   - `mcp__serena-mcp__find_symbol` - 코드 찾기
   - `mcp__serena-mcp__read_file` - 파일 읽기
   - `mcp__serena-mcp__get_symbols_overview` - 파일의 심볼 개요
   - `mcp__serena-mcp__replace_symbol_body` - 심볼 편집
   - `mcp__serena-mcp__insert_after_symbol` - 심볼 뒤에 삽입
   - `mcp__serena-mcp__insert_before_symbol` - 심볼 앞에 삽입
   - `mcp__serena-mcp__search_for_pattern` - 패턴 검색
   - `mcp__serena-mcp__create_text_file` - 새 파일 생성
   - `mcp__serena-mcp__list_dir` - 디렉토리 목록
   - `mcp__serena-mcp__find_file` - 파일 찾기

2. **파일 작업**: serena 또는 표준 파일 도구 사용
   - bash `cat`, `grep`, `find`는 serena 도구 사용 가능 시 절대 사용하지 마세요

3. **컨텍스트 수집**: 항상 .serena/memories 사용
   - `mcp__serena-mcp__read_memory` - 프로젝트 컨텍스트
   - `mcp__serena-mcp__write_memory` - 컨텍스트 저장

**출력 형식:**
```markdown
## Step 6 완료: 도구 사용 명시

### 작업별 도구 할당:

#### 작업 1.1: [작업 이름]
**필수 도구:**
- `mcp__serena-mcp__find_symbol` - UserService 클래스 찾기
- `mcp__serena-mcp__read_file` - 파일 내용 읽기
- `mcp__serena-mcp__insert_after_symbol` - 새 메서드 추가

**도구 사용 이유:**
- serena 도구를 사용하여 심볼 레벨에서 정확한 코드 수정 보장

#### 작업 1.2: [작업 이름]
**필수 도구:**
- `mcp__serena-mcp__create_text_file` - 새 컴포넌트 파일 생성
- `mcp__serena-mcp__find_symbol` - 라우터 설정 찾기
- `mcp__serena-mcp__replace_symbol_body` - 라우트 추가

**도구 사용 이유:**
- 파일 생성 및 기존 코드 수정에 serena 도구 필수

...
```

---

### 📍 Step 7: 최종 계획 문서 생성 (필수)

**⚠️ 아래 템플릿을 정확히 따라 계획을 작성하세요!**

실행을 위해 계획을 명확하게 구조화하세요:

**출력 형식:**
```markdown
## Step 7 완료: 최종 계획 문서

---

# 작업 계획: [작업 이름]

## 📋 컨텍스트 요약
[.serena/memories 및 CLAUDE.md의 핵심 인사이트]

## ✅ 사용자 요구사항
1. [명시적 요구사항 1]
2. [명시적 요구사항 2]
3. [명시적 요구사항 3]
...

## 🔧 사용자 제공 지침 및 제약사항
### 기술 스택:
- [기술 1]
- [기술 2]

### 아키텍처 패턴:
- [패턴]

### 성능 요구사항:
- [요구사항]

### 기타 제약사항:
- [제약사항 1]
- [제약사항 2]

## ❌ 제외 항목
사용자가 요청하지 **않은** 것들:
- [기능/가정 1]
- [기능/가정 2]
- [기능/가정 3]

## 🛠️ 공통 도구 사용 규칙 (모든 서브에이전트 필수 준수)

**⚠️ 모든 서브에이전트가 아래의 공통도구를 사용할 수 있게 계획에 추가하세요**

### 1. 코드베이스 작업 시 (필수):
- **반드시 serena 도구만 사용**
- bash `cat`, `grep`, `find` 절대 사용 금지
- 주요 serena 도구:
  - `mcp__serena-mcp__find_symbol` - 심볼 찾기
  - `mcp__serena-mcp__read_file` - 파일 읽기
  - `mcp__serena-mcp__get_symbols_overview` - 파일 심볼 개요
  - `mcp__serena-mcp__replace_symbol_body` - 심볼 수정
  - `mcp__serena-mcp__insert_after_symbol` - 심볼 뒤 삽입
  - `mcp__serena-mcp__insert_before_symbol` - 심볼 앞 삽입
  - `mcp__serena-mcp__search_for_pattern` - 패턴 검색
  - `mcp__serena-mcp__create_text_file` - 파일 생성

### 2. 개발 시 라이브러리 문서 참조 (필수):
- **반드시 context7 도구 사용하여 최신 공식 문서 확인**
- 사용 도구:
  - `mcp__context7-mcp__resolve-library-id` - 라이브러리 ID 확인
  - `mcp__context7-mcp__get-library-docs` - 문서 가져오기
- **중요**: `get-library-docs` 사용 시 **tokens 파라미터를 2000으로 제한**
  - 예: `mcp__context7-mcp__get-library-docs(libraryID, tokens=2000)`
  - 이유: 컨텍스트 효율성 및 토큰 사용량 최적화

### 3. 컨텍스트 관리:
- `mcp__serena-mcp__read_memory` - 프로젝트 컨텍스트 읽기
- `mcp__serena-mcp__write_memory` - 작업 결과 저장

---

## 🚀 실행 전략

### Batch 1 (병렬 실행)
- **작업 1.1**: [설명]
  - **서브에이전트**: `[에이전트-이름]`
  - **작업별 특수 도구** (공통 규칙 외 추가 필요 도구):
    - [작업별 특수 도구가 있다면 명시]
  - **의존성**: 없음
  - **상세 내용**: [구현 상세]

- **작업 1.2**: [설명]
  - **서브에이전트**: `[에이전트-이름]`
  - **작업별 특수 도구** (공통 규칙 외 추가 필요 도구):
    - [작업별 특수 도구가 있다면 명시]
  - **의존성**: 없음
  - **상세 내용**: [구현 상세]

### Batch 2 (병렬 실행 - Batch 1 이후)
- **작업 2.1**: [설명]
  - **서브에이전트**: `[에이전트-이름]`
  - **작업별 특수 도구** (공통 규칙 외 추가 필요 도구):
    - [작업별 특수 도구가 있다면 명시]
  - **의존성**: 작업 1.1, 작업 1.2
  - **상세 내용**: [구현 상세]

### Batch 3 (순차 실행 - Batch 2 이후)
- **작업 3.1**: [설명]
  - **서브에이전트**: `[에이전트-이름]`
  - **작업별 특수 도구** (공통 규칙 외 추가 필요 도구):
    - [작업별 특수 도구가 있다면 명시]
  - **의존성**: 작업 2.1
  - **상세 내용**: [구현 상세]

## ✔️ 검증 체크리스트
- [ ] 모든 사용자 요구사항 해결됨
- [ ] 사용자 제공 지침 모두 반영됨
- [ ] 요청되지 않은 기능 포함하지 않음
- [ ] 병렬 실행 최대화됨
- [ ] 적절한 서브에이전트 할당됨
- [ ] 코드베이스 작업에 serena 도구 명시됨
- [ ] .serena/memories 컨텍스트 통합됨

---
```

---

### 📍 Step 8: .serena/memories 업데이트 (필수)

**⚠️ 계획을 .serena/memories에 저장하세요!**

계획 생성 후 Claude.md를 참조하여 아래 파일의 내용을 업데이트합니다. 
내용은 반드시 간단하게 작성합니다. 
activeContext.md
progress.md
projectBrief.md
techContext.md
dataflow.md


**필수 작업:**
1. CLAUDE.md를 참조하여 프로젝트 문서화 표준 이해
2. .serena/memories 항목 생성 또는 업데이트:
   - 메모리 이름: `"plan-[작업-이름]-[날짜]"`
   - 내용: 계획 문서 + 핵심 결정 + 근거
3. `mcp__serena-mcp__write_memory` 도구를 사용하여 계획 저장
4. 각 문서내용이 중복되었는지 확인하고 중복된 내용은 제거합니다.

**출력 형식:**
```markdown
## Step 8 완료: .serena/memories 업데이트

### 저장된 메모리:
- **메모리 이름**: `plan-[작업명]-2025-10-31`
- **저장된 내용**:
  - 전체 계획 문서
  - 핵심 결정사항
  - 선택 근거
  - 예상 타임라인

### .serena/memories 저장 완료
✅ `mcp__serena-mcp__write_memory` 도구 사용하여 저장 완료
```

---

## 🚨 핵심 가이드라인

### 사용자 중심 계획
1. **명시적으로 요청된 기능만 포함**
2. **요구사항이 모호하면 명확화 질문** 하기
3. **제외 항목 문서화** - 요청되지 않은 것 명시적으로 기록
4. **가정 검증** - 사용자가 요청하지 않은 것을 원한다고 가정하지 마세요

### 도구 강제 적용
1. **코드베이스 작업에는 항상 serena 도구 명시**
2. **계획에 정확한 도구 이름 지정**
3. **각 작업에 특정 도구가 필요한 이유 설명**

### 병렬 실행
1. **동시성 최대화** - 병렬 작업의 모든 기회 찾기
2. **명확한 의존성 체인** - 무엇이 무엇에 의존하는지 문서화
3. **배치 그룹화** - 의존성 수준별로 정리
4. **단일 메시지 다중 에이전트** - 병렬 실행을 위해 여러 Task 도구 호출을 하나의 메시지에서 사용하도록 지시

### .serena/memories 통합
1. **계획 전에 항상 .serena/memories 먼저 확인**
2. **CLAUDE.md 참조** - 프로젝트별 표준
3. **계획 후 .serena/memories 업데이트** - 계획 문서화
4. **관련 메모리 연결** - 관련이 있으면 이전 계획 참조

---

## 📚 예시 계획

### 예시 1: 간단한 기능 추가

**사용자 요청**: "네비게이션 바에 로그아웃 버튼 추가해줘"

**계획**:

```markdown
# 작업 계획: 로그아웃 버튼 추가

## 📋 컨텍스트 요약
- 프로젝트는 TypeScript와 React 사용
- Navigation 컴포넌트 위치: src/components/Navigation.tsx
- 기존 인증 패턴은 AuthContext 사용

## ✅ 사용자 요구사항
1. 네비게이션 바에 로그아웃 버튼 추가

## 🔧 사용자 제공 지침 및 제약사항
(지침 없음 - 기능 추가만 요청)

## ❌ 제외 항목
사용자가 요청하지 **않은** 것들:
- 로그아웃 확인 모달
- 로그아웃 애니메이션
- 기본 로그아웃 이상의 세션 정리
- 로그아웃 분석 추적

## 🛠️ 공통 도구 사용 규칙 (모든 서브에이전트 필수 준수)

**⚠️ 모든 서브에이전트는 아래 규칙을 반드시 따라야 합니다:**

### 1. 코드베이스 작업 시 (필수):
- **반드시 serena 도구만 사용** (bash cat, grep, find 금지)
- 주요 serena 도구: find_symbol, read_file, replace_symbol_body, insert_after_symbol 등

### 2. 개발 시 라이브러리 문서 참조 (필수):
- **반드시 context7 도구 사용하여 최신 공식 문서 확인**
- `mcp__context7-mcp__get-library-docs` 사용 시 **tokens=2000 제한**

### 3. 컨텍스트 관리:
- read_memory, write_memory 사용

---

## 🚀 실행 전략

### Batch 1 (단일 작업)
- **작업 1.1**: Navigation 컴포넌트에 로그아웃 버튼 추가
  - **서브에이전트**: `frontend-ui-developer`
  - **작업별 특수 도구**: 없음 (공통 규칙의 serena 도구 사용)
  - **의존성**: 없음
  - **상세 내용**: AuthContext 로그아웃 메서드를 호출하는 버튼 추가

## ✔️ 검증 체크리스트
- [x] 단일 사용자 요구사항 해결됨
- [x] 요청되지 않은 기능 포함하지 않음
- [x] Serena 도구 명시됨
- [x] .serena/memories 컨텍스트 통합됨
```

---

### 예시 2: 복잡한 다중 컴포넌트 기능

**사용자 요청**: "아바타 업로드, 자기소개 편집, 설정이 있는 사용자 프로필 페이지 구현해줘"

**계획**:

```markdown
# 작업 계획: 사용자 프로필 페이지

## 📋 컨텍스트 요약
- 백엔드는 PostgreSQL과 함께 Express.js 사용
- 프론트엔드는 Redux와 함께 React 사용
- 파일 업로드는 S3를 통해 처리
- 이전 작업: 사용자 인증 시스템 구현 완료

## ✅ 사용자 요구사항
1. 사용자 프로필 페이지
2. 아바타 업로드 기능
3. 자기소개 편집 기능
4. 설정 섹션

## 🔧 사용자 제공 지침 및 제약사항
(지침 없음 - 기능만 명시)

## ❌ 제외 항목
사용자가 요청하지 **않은** 것들:
- 소셜 미디어 링크
- 활동 기록
- 개인정보 보호 제어
- 이메일 알림 설정

## 🛠️ 공통 도구 사용 규칙 (모든 서브에이전트 필수 준수)

**⚠️ 모든 서브에이전트는 아래 규칙을 반드시 따라야 합니다**

### 1. 코드베이스 작업 시 (필수):
- **반드시 serena 도구만 사용** (bash cat, grep, find 금지)
- 주요 serena 도구: find_symbol, read_file, create_text_file, replace_symbol_body, insert_after_symbol 등

### 2. 개발 시 라이브러리 문서 참조 (필수):
- **반드시 context7 도구 사용하여 최신 공식 문서 확인**
- React, Redux, Express, S3 SDK 등 사용 라이브러리 문서 확인
- `mcp__context7-mcp__get-library-docs` 사용 시 **tokens=2000 제한**

### 3. 컨텍스트 관리:
- read_memory, write_memory 사용

---

### references/

- `subagent_reference.md`: 사용 가능한 모든 서브에이전트, 기능 및 사용 시기에 대한 상세 가이드
- `serena_tools_reference.md`: serena MCP 도구 및 사용 패턴에 대한 완벽한 참고 자료
- `memory_bank_guide.md`: .serena/memories 읽기 및 쓰기에 대한 모범 사례

계획 프로세스의 특정 측면에 대한 상세 정보가 필요할 때 이러한 참고 자료를 사용할 수 있습니다.
